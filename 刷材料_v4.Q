[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=122
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=a1ad0cf4-e753-4e31-971c-c8294353512e
Description=刷材料_v4
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
//******** Windows
hwnd = Plugin.Window.Find("Ragnarok", "Ragnarok")
Call Plugin.Window.Move(hwnd, 0, 0)

//******** User Parameters
UserVar About__ = DropList{"*********":1}=1 "** About "
UserVar gScriptAuthor = DropList{"Wade.Yeh":1}=1 "Author"
UserVar gScriptVersion = DropList{"20220814A":1}=1 "Version"
//**** Options
UserVar Options__ = DropList{"*********":1}=1 "** Options "
UserVar gEnCheckInCity = DropList{"Enable":1 | "Disable":0}=1 "Check in City"
UserVar gEnableFuzzy = DropList{"Enable":1 | "Disable":0}=1 "Fuzzy"
UserVar gEnSkill1Ckick = DropList{"Enable":1 | "Disable":0}=1 "Skill 1 Click Ground"
UserVar gEnSkill2Ckick = DropList{"Enable":1 | "Disable":0}=1 "Skill 2 Click Ground"
UserVar gTrigSupport1AtBeginning = DropList{"Enable":1 | "Disable":0}=1 "Trig support 1 at beginning"
UserVar gTrigSupport2AtBeginning = DropList{"Enable":1 | "Disable":0}=1 "Trig support 2 at beginning"

//**** Keys
UserVar Keys__ = DropList{"*********":1}=1 "** Keys "
UserVar gRecoveryKey = "1" "Recovery Key(0-9 A-Z)"
UserVar gFlyKey = "2" "Fly Key(0-9 A-Z)"
UserVar gButterflyKey = "B" "Butterfly Key(0-9 A-Z)"
UserVar gSkillKey1 = "E" "Skill 1 Key(0-9 A-Z)"
UserVar gSkillKey2 = "E" "Skill 2 Key(0-9 A-Z)"
UserVar gSupportKey1 = "R" "Support 1 Key(0-9 A-Z)"
UserVar gSupportKey2 = "M" "Support 2 Key(0-9 A-Z)"

//**** Delay
UserVar Delay__ = DropList{"*********":1}=1 "** Delay "
UserVar gLoopDelay = 50 "Loop Delay(ms)"
UserVar gFlyDelay = 550 "Fly Delay(ms)"
UserVar gSkill1Delay = 75 "Skill 1 Delay(ms)"
UserVar gSkill2Delay = 900 "Skill 2 Delay(ms)"
UserVar gDelayFuzzyPercent = 25 "Delay Fuzzy(%)"
UserVar gSupport1Timer = 0 "Support 1 Timer(s)(0 = Disable)"
UserVar gSupport2Timer = 0 "Support 2 Timer(s)(0 = Disable)"

//**** Loop
UserVar Loop__ = DropList{"*********":1}=1 "** Loop "
UserVar gSkill1Loop = 2 "Skill 1 Loop"
UserVar gSkill2Loop = 0 "Skill 2 Loop"
UserVar gLoopRecovery = 10 "Loop and Recovery"

//**** Verify
UserVar Verify__ = DropList{"*********":1}=1 "** Verify "
UserVar gEnableVerify = DropList{"Enable":1 | "Disable":0}=1 "Enable Verify"
UserVar gVerifyTime = 1 "Check Veritication every n min"

//**** Auto Store
UserVar AutoStore__ = DropList{"*********":1}=1 "** AutoStore "
UserVar gEnAutoStore = DropList{"Enable":1 | "Disable":0}=1 "Enable Auto Store"
UserVar gAutoStoreTime = 1 "Auto Store every n min"
UserVar gAutoStoreNum = 2 "Auto Store n Items"

//******** Parameters
Dim cTrue
cTrue = 1
Dim cFalse
cFalse = 0

gCharacterXY = array(840-50, 520)
//** SupportTimer
Dim gSupport1TimerInit
Dim gSupport1TimerCurr
Dim gSupport2TimerInit
Dim gSupport2TimerCurr

//**** Chenk in City
gChkMapCoordinate1 = array(1600, 46, 1645, 100)	// LUX, LUY, RDX, RDY	// 確認不再城內1（走歪無法判斷）
gOpenMapXY = array(1634, 181)
gChkMapCoordinate2 = array(1136, 221, 1332, 237)	// LUX, LUY, RDX, RDY	// 確認不再城內2
// Chenk in City ****

//**** Verify
//** Coordinate
gDelta = 1
gBackButtomXY = array(1507, 123)
gStringTryCount = 10
gString1Coordinate = array(23-gDelta, 386-gDelta, 93+gDelta, 396+gDelta)	// LUX, LUY, RDX, RDY	// String1: 外掛驗證裝置
// gString2Coordinate = array(21-gDelta, 212-gDelta, 163+gDelta, 222+gDelta)	// LUX, LUY, RDX, RDY	// String2: 您現在不需要進行驗證
gString3Coordinate = array(21-gDelta, 212-gDelta, 127+gDelta, 222+gDelta)	// LUX, LUY, RDX, RDY	// String3: 您好請您輸入外掛驗證
gVerifyCodeCoordinate = array(75-gDelta, 303-gDelta, 109+gDelta, 311+gDelta)	// LUX, LUY, RDX, RDY
gVCodeNumDelta = 6
gVCodeNumTryCount = 1
gVCodeNum = array(75-gDelta, 303-gDelta, 79+gDelta, 311+gDelta)	// LUX, LUY, RDX, RDY

//** Timer
Dim gVerifyTimerInitial
Dim gVerifyTimerCurrent
// Verify ****

//**** Auto Store
//** Coordinate
// gCapraXY = array(520, 810)
gCapraXY = array(520, 675)
//gTranNpcXY = array(690, 420)
gTranNpcXY = array(690, 260)
gBagPage3XY = array(620, 970)
gBagItem1XY = array(665, 905)
gBagItem2XY = array(695, 905)
gStorehouseXY = array(740, 740)
gStorehouseCloseXY = array(850, 860)

//** Timer
Dim gAutoSTimerInitial
Dim gAutoSTimerCurrent

//AutoMoney ****

Function keyLoops(uKey, uLoops, uDelay)
	For uLoops
		Call Plugin.Bkgnd.KeyPress(hwnd, uKey)
		Delay uDelay
	Next
End Function

Function dropAtoB(uAX, uAY, uBX, uBY)
	MoveTo uAX, uAY
	Delay 250
	LeftDown 1
	Delay 250
	MoveTo uBX, uBY
	Delay 350
	LeftUp 1
	Delay 250
End Function

Function findCoordinateNum(uLUX, uLUY, uRDX, uRDY, uNum)
	Dim uWBreak
	Dim uTargetString
	Dim uResult
	uResult = cFalse
	uNum = CStr(uNum)
	uTargetString = "Attachment:\"+uNum+".bmp"
	
	uWBreak=gVCodeNumTryCount
	While(uWBreak>0)
		FindPic uLUX, uLUY, uRDX, uRDY, uTargetString, 1, intX, intY
		If intX > 0 And intY > 0 Then
    		TracePrint "Find: "+uNum+".bmp"
    		uWBreak = 0
    		uResult = cTrue
    	// Else 
    	//	TracePrint "Not Found: "+uNum+".bmp"
		End If
		Delay 25
		uWBreak = uWBreak - 1
	Wend
	findCoordinateNum = uResult
End Function

Function initialTimer()
	gVerifyTimerInitial = Plugin.GetSysInfo.GetTime
	gVerifyTimerCurrent = Plugin.GetSysInfo.GetTime
	gAutoSTimerInitial = Plugin.GetSysInfo.GetTime
	gAutoSTimerCurrent = Plugin.GetSysInfo.GetTime
	gSupport1TimerInit = Plugin.GetSysInfo.GetTime
	gSupport1TimerCurr = Plugin.GetSysInfo.GetTime
	gSupport2TimerInit = Plugin.GetSysInfo.GetTime
	gSupport2TimerCurr = Plugin.GetSysInfo.GetTime
End Function

Function mainFunction()
	Dim uWBreak
	Dim uChkMapBreak
	Dim uVerifyStatus
	Dim uAutoStoreStatus
	Call initialTimer()
	uVerifyStatus=0 // 0: Wait
	uAutoStoreStatus=0	// 0: Wait
	uChkMapBreak = 0
	If (gEnableFuzzy = 0) Then 
		gDelayFuzzyPercent=0
	End If
	
	// UseSupport at beginning	
	If ( (gSupport1Timer > 0) and (gTrigSupport1AtBeginning > 0) ) Then 
		Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gSupportKey1))
		Delay 100
	End If
	
	If ( (gSupport2Timer > 0) and (gTrigSupport2AtBeginning > 0) ) Then 
		Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gSupportKey2))
		Delay 100
	End If
	
	While (1)
		//**** Check not in City
		If (gEnCheckInCity = 1) Then 
			While (uChkMapBreak = 0)
				Delay 500
				MoveTo gOpenMapXY(0), gOpenMapXY(1)
				Delay 25
				LeftClick 1
				Delay 500
				FindPic gChkMapCoordinate2(0),gChkMapCoordinate2(1),gChkMapCoordinate2(2),gChkMapCoordinate2(3),"Attachment:\盧恩米德加茲王國 首都普隆德拉.bmp",0.9,intX,intY
				If intX > 0 And intY > 0 Then
    				TracePrint "Found: 在普隆德拉城內!!!!"
					Delay 1000
    				uChkMapBreak = 0
    			Else 
    				TracePrint "Not Found: 不在普隆德拉，可安心掛機！"
    				uChkMapBreak = 1
				End If	
				Delay 500
				MoveTo gOpenMapXY(0), gOpenMapXY(1)
				Delay 25
				LeftClick 1
				Delay 25
			Wend	
		End If
    	uChkMapBreak = 1
    	
		//**** Fly and Attack
		For gLoopRecovery
			Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gFlyKey))
			Delay CInt(gFlyDelay * (100 + (Rnd * gDelayFuzzyPercent * 2 - gDelayFuzzyPercent)) / 100)
			
			For gSkill1Loop
				Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gSkillKey1))
				If (gEnSkill1Ckick = 1) Then 
					Delay 25
					MoveTo gCharacterXY(0), gCharacterXY(1)
					Delay 50
					LeftClick 1
				End If
				Delay CInt(gSkill1Delay * (100 + (Rnd * gDelayFuzzyPercent * 2 - gDelayFuzzyPercent)) / 100)
			Next
			
			For gSkill2Loop
				Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gSkil2Key1))
				If (gEnSkill2Ckick = 1) Then 
					Delay 25
					MoveTo gCharacterXY(0), gCharacterXY(1)
					Delay 25
					LeftClick 1
				End If
				Delay CInt(gSkill2Delay * (100 + (Rnd * gDelayFuzzyPercent * 2 - gDelayFuzzyPercent)) / 100)
			Next
		Next
		// Fly and Attack ****

		//**** Recovery
		Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gRecoveryKey))
		// Recovery ****
		
		//**** Support 1
		If (gSupport1Timer > 0) Then 
			gSupport1TimerCurr = Plugin.GetSysInfo.GetTime
			If ((gSupport1TimerCurr - gSupport1TimerInit) > (gSupport1Timer*1000)) Then 
				Delay 600
				Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gSupportKey1))	
				Delay 100
				gSupport1TimerInit = Plugin.GetSysInfo.GetTime
				gSupport1TimerCurr = Plugin.GetSysInfo.GetTime
			End If	
		End If
		// Support 1 ****
		
		//**** Support 2
		If (gSupport2Timer > 0) Then 
			gSupport2TimerCurr = Plugin.GetSysInfo.GetTime
			If ((gSupport2TimerCurr - gSupport2TimerInit) > (gSupport2Timer*1000)) Then 
				Delay 600
				Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gSupportKey2))	
				Delay 100
				gSupport2TimerInit = Plugin.GetSysInfo.GetTime
				gSupport2TimerCurr = Plugin.GetSysInfo.GetTime
			End If	
		End If
		// Support 2 ****
		
		//**** Check Verify
		If (gEnableVerify=1) Then 
			gVerifyTimerCurrent = Plugin.GetSysInfo.GetTime
			If ((gVerifyTimerCurrent - gVerifyTimerInitial) >= (gVerifyTime * 60 * 1000)) Then 
    			TracePrint "Check Verify."
				uVerifyStatus = 1
			End If
		End If
		
		If (uVerifyStatus>0) Then 
			//** Click "Back" Buttom
			MoveTo gBackButtomXY(0), gBackButtomXY(1)
			Delay 25
			LeftClick 1
			uVerifyStatus=2	// 2: To find "外掛驗證裝置"
			Delay 250
			//** 尋找"外掛驗證裝置"
			If (uVerifyStatus = 2) Then 
				uWBreak=gStringTryCount
				While(uWBreak>0)
					FindPic gString1Coordinate(0),gString1Coordinate(1),gString1Coordinate(2),gString1Coordinate(3),"Attachment:\外掛驗證裝置.bmp",0.9,intX,intY
					If intX > 0 And intY > 0 Then
    					TracePrint "Found: 外掛驗證裝置."
    					uWBreak = 0
    					uVerifyStatus = 3 // 3: Click "Enter"
    				Else 
    					TracePrint "Not Found: 外掛驗證裝置."
					End If	
					Delay 25
					uWBreak = uWBreak - 1
				Wend
			End If
			
			If (uVerifyStatus = 3) Then 
				Call Plugin.Bkgnd.KeyPress(hwnd, 13)
				uVerifyStatus = 4 // 4: To find "您好請您輸入外掛驗證"
			End If
			
			//** 尋找"您好請您輸入外掛驗證"
			If (uVerifyStatus = 4) Then 
				uWBreak=gStringTryCount
				While(uWBreak>0)
					FindPic gString3Coordinate(0),gString3Coordinate(1),gString3Coordinate(2),gString3Coordinate(3),"Attachment:\您好請您輸入外掛驗證.bmp",0.9,intX,intY
					If intX > 0 And intY > 0 Then
    					TracePrint "Found: 您好請您輸入外掛驗證."
    					uWBreak=0
    					uVerifyStatus = 5 // 5: To Decode the code"
    				Else 
    					TracePrint "Not Found: 您好請您輸入外掛驗證."
					End If
					Delay 25
					uWBreak = uWBreak - 1
					If (uWBreak = 0) Then 
						Call Plugin.Bkgnd.KeyPress(hwnd, 13)
						uVerifyStatus=0
						gVerifyTimerInitial = Plugin.GetSysInfo.GetTime
						gVerifyTimerCurrent = gVerifyTimerInitial
					End If
				Wend
			End If
			
			//** Decode the code
			If (uVerifyStatus = 5) Then 
				Dim uPlaceIndex
				Dim uNumIndex
				Dim uResult
				Dim uLUX
				Dim uLUY
				Dim uRDX
				Dim uRDY
				
				For (6)
					uLUX = gVCodeNum(0) + uPlaceIndex * gVCodeNumDelta
					uLUY = gVCodeNum(1)
					uRDX = gVCodeNum(2) + uPlaceIndex * gVCodeNumDelta
					uRDY = gVCodeNum(3)
					uNumIndex=0
					For (10)
						uResult = findCoordinateNum(uLUX, uLUY, uRDX, uRDY, uNumIndex)
						If (uResult = cTrue) Then 
							TracePrint "Enter Number "+CStr(uNumIndex)
							Call Plugin.Bkgnd.KeyPress(hwnd, Asc(uNumIndex))
							Exit For
						End If
						uNumIndex=uNumIndex+1
					Next
					uPlaceIndex=uPlaceIndex+1
				Next
				Delay 50
				Call Plugin.Bkgnd.KeyPress(hwnd, 13)
				Delay 150
				Call Plugin.Bkgnd.KeyPress(hwnd, 13)
				Delay 50
				uVerifyStatus=0
				gVerifyTimerInitial = Plugin.GetSysInfo.GetTime
				gVerifyTimerCurrent = gVerifyTimerInitial
			End If
			
			//** Timeout(2 * gVerifyTime min)
			gVerifyTimerCurrent = Plugin.GetSysInfo.GetTime
			If ((gVerifyTimerCurrent - gVerifyTimerInitial) >= (2 * gVerifyTime * 60 * 1000)) Then 
				uVerifyStatus=0
				gVerifyTimerInitial = Plugin.GetSysInfo.GetTime
				gVerifyTimerCurrent = gVerifyTimerInitial
			End If
		End If
		// Check Verify ****
		
		//**** Auto Store
		If (gEnAutoStore=1) Then 
			gAutoSTimerCurrent = Plugin.GetSysInfo.GetTime
			If ((gAutoSTimerCurrent - gAutoSTimerInitial) >= (gAutoStoreTime * 60 * 1000)) Then 
    			TracePrint "Auto Store."
				uAutoStoreStatus = 1
			End If
		End If
		If (uAutoStoreStatus = 1) Then 
			// Go Home and Sit
			Delay 500
			Call Plugin.Bkgnd.KeyPress(hwnd, Asc(gButterflyKey))
			Delay 5000
			Call Plugin.Bkgnd.KeyPress(hwnd, 45)
			Delay 1000
			
			// Open Store House
			MoveTo gCapraXY(0), gCapraXY(1)
			Delay 100
			LeftClick 1
			Delay 100
			Call keyLoops(13, 2, 500)
			
			// Switch to Bag page 3
			MoveTo gBagPage3XY(0), gBagPage3XY(1)
			Delay 100
			LeftClick 1
			Delay 250
			
			// Store Item * gAutoStoreNum
			For gAutoStoreNum
				Call dropAtoB(gBagItem1XY(0), gBagItem1XY(1), gStorehouseXY(0), gStorehouseXY(1))
				Call Plugin.Bkgnd.KeyPress(hwnd, 13)
				Delay 100
			Next
			
			// Close Store House
			MoveTo gStorehouseCloseXY(0), gStorehouseCloseXY(1)
			Delay 100
			LeftClick 1
			Delay 250
			
			// Go Back to Map
			MoveTo gTranNpcXY(0), gTranNpcXY(1)
			Delay 100
			LeftClick 1
			Delay 500
			Call keyLoops(13, 5, 500)
			Delay 1500
			uAutoStoreStatus = 0
			gAutoSTimerInitial = Plugin.GetSysInfo.GetTime
			gAutoSTimerCurrent = gAutoSTimerInitial
    		uChkMapBreak = 0
		End If
		// Auto Money ****
		
		Delay CInt(gLoopDelay * (100 + (Rnd * gDelayFuzzyPercent * 2 - gDelayFuzzyPercent)) / 100)
	Wend
End Function


Call mainFunction()
